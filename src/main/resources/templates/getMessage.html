<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/css/bootstrap.min.css" integrity="sha384-HSMxcRTRxnN+Bdg0JdbxYKrThecOKuH5zCYotlSAcp1+c8xmyTe9GYg1l9a69psu" crossorigin="anonymous">
<head>
    <p class="text-center" style="font-size:30px;">Note management panel</p>
</head>
<body style="overflow: hidden;">
<div id="updateForm" style="position:absolute;left:25%;top:25%;z-index:2;background-color:white;width:50%;height:50%;">
    <form th:action="@{/message/panel/update}" th:object="${messageDto}" th:method="post">
        <p class="text-center" style="font-size:20px;margin-top:30px">Update note</p>
        <div class="text-right">
            <button id="close-button" type="button" class="btn btn-secondary" style="left:80%;position:absolute;top:8%;" data-bs-dismiss="modal" onclick="closeUpdateForm()">x</button>
        </div>
        <input id="updateInput" type="text" style="visibility:hidden;" th:field="*{messageId}"/>
        <textarea maxlength="255"  placeholder="255 or less characters" id="updateField" class="form-control" style="resize:none;height:50%;" type="text" th:field="*{message}"/>
        <button type="submit" style="margin-top:15;" class="btn btn-success btn-outline" onclick="validateUpdateField()">Update</button>
    </form>
</div>
<div id="main-section">
    <div class="alert alert-warning text-center" style="margin-bottom:50px;" th:if="${#lists.size(messages) == 0}">No notes present!</div>
    <div>
        <table class="table overflow-scroll" th:if="${#lists.size(messages) > 0}">
            <thead>
            <tr>
                <th scope="col">Note</th>
            </tr>
            </thead>
            <tbody>
            <tr scope="col" th:each="note : ${messages}">
                <td th:text="${note.message}">Note</td>
                <td>
                    <form th:action="@{/message/panel/delete}" th:method="post">
                        <input id="idInput" style="visibility:hidden;" th:value="${note.messageId}" type="text" name="messageId"/>
                        <button th:data-id="${note.messageId}" th:data-message="${note.message}" class="btn btn-primary" type="button" onclick="editForm(this.getAttribute('data-id'), this.getAttribute('data-message'))">edit</button>
                        <button class="btn btn-danger" type="submit">delete</button>
                    </form>
                </td>
            </tr>
            </tbody>
        </table>
        <p class="text-center" style="font-size:20px;">Add note</p>
        <form th:action="@{/message/panel/create}" th:object="${messageDto}" th:method="post">
            <textarea maxlength="255" class="form-control" style="resize:none;" placeholder="255 or less characters" rows="5" type="text" th:field="*{message}"/>
            <button type="submit" style="margin-top:15px;" class="btn btn-success btn-outline">Add</button>
            <div class="alert alert-warning" th:if="${#fields.hasErrors('message')}" th:errors="*{message}"></div>
        </form>
    </div>
</div>
</body>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.4/jquery-ui.min.js" type="text/javascript"></script>
<script>
    $("#updateForm").draggable();

    function editForm(messageId, message)
    {
    $("#updateForm").css("visibility", "visible");
    document.getElementById("updateInput").value = messageId;
    document.getElementById("updateField").value = message;
    }

    function closeUpdateForm()
    {
    $("#updateForm").css("visibility", "hidden")
    }
</script>
<style>
    .btn-success.btn-outline {
    background-color: #5cb85c;
}
    .btn-success:hover
    {
    background-color: #154734;
    }
    #updateForm
    {
    width: 250px;
  box-shadow: rgba(0, 0, 0, 0.56) 0px 22px 70px 4px;
  text-align: center;
  border: 2px solid white;
  border-radius:30px;
  visibility:hidden;
  draggable:true;
    }
    #main-section
    {
    position: fixed;
    top: 50%;
    left: 50%;
    width:50%;
    -webkit-transform: translate(-50%, -50%);
    transform: translate(-50%, -50%);
    }
    #close-button:hover
    {
    background-color:#666666
    }
</style>
</html>